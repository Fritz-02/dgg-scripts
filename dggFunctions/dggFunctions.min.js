const settingsForm=document.querySelector("#chat-settings-form"),chatLines=document.querySelector(".chat-lines");class SettingItem{constructor(e,t,n,s){this.keyName=e,this.defaultValue=t,this.type=n,this.options=s,this.parent}build(){const e=document.createElement("div");e.className="form-group row";const t=document.createElement("label");let n;t.innerHTML=this.options.text,void 0!==this.options.hint&&(t.title=this.options.hint),e.appendChild(t);let s=!0;switch(this.type){case"checkbox":e.className="form-group checkbox",n=document.createElement("input"),void 0!==this.options.name&&(t.name=this.options.name),n.type="checkbox",n.checked=this.parent[this.keyName],n.addEventListener("change",(()=>{this.parent[this.keyName]=n.checked})),t.prepend(n),s=!1;break;case"input-number":t.style.marginBottom=0,n=document.createElement("input"),void 0!==this.options.name&&(t.name=this.options.name),n.type="number",n.className="form-control",n.min=this.options.min,n.max=this.options.max,n.placeholder=this.options.placeholder,n.value=this.parent[this.keyName],n.style.marginLeft=".6em",n.addEventListener("change",(()=>{this.parent[this.keyName]=n.value}));break;case"select":e.className="form-group",t.htmlFor=this.options.id,n=document.createElement("select"),n.id=this.options.id,this.options.name&&(t.name=this.options.name),n.className="form-control";for(const e in this.options.options){const t=document.createElement("option");t.value=e,t.innerHTML=this.options.options[e],n.appendChild(t)}n.value=this.parent[this.keyName],n.addEventListener("change",(()=>{this.parent[this.keyName]=parseInt(n.value)}));break;case"textarea":n=document.createElement("textarea"),n.style.resize="vertical",n.className="form-control",n.placeholder=this.options.placeholder,n.value=this.parent[this.keyName],n.addEventListener("change",(()=>{let e=n.value.toLowerCase().replaceAll(" ","").split(",").filter(String);n.value.length>0?this.parent[this.keyName]=e:this.parent[this.keyName]=[]}));break;case"input":n=document.createElement("input"),n.className="form-control",n.placeholder=this.options.placeholder,n.value=this.parent[this.keyName],n.addEventListener("change",(()=>{let e=n.value.replaceAll(" ","");n.value.length>0?this.parent[this.keyName]=e:this.parent[this.keyName]=null}));break;default:console.error(`Invalid setting input type: ${this.type}`)}s&&e.appendChild(n),settingsForm.appendChild(e)}}class Settings{#e;#t;constructor(e,t,n){this.title=e,this.#e=t,this.#t=n;for(const e of this.#e){e.parent=this;const t=e.keyName,n=`#${t}`;Object.defineProperty(this,t,{set:function(e){this[n]=e,this.#n(t,e)},get:function(){return void 0===this[n]&&(this[n]=this.#s(t)??e.defaultValue),this[n]}})}}#i(e){return`${this.#t}${e}`}#n(e,t){const n=this.#i(e);window.localStorage.setItem(n,JSON.stringify(t))}#s(e){const t=this.#i(e),n=window.localStorage.getItem(t);if(null!=n){return JSON.parse(n)}}build(){const e=document.createElement("h4");e.innerHTML=this.title,settingsForm.appendChild(e);for(const e of this.#e)e.build()}}const userInfo=document.querySelector("div.user-info"),actionButtons=document.querySelector("div.action-buttons");function insertInfoHeader(e,t,n){const s=document.createAttribute("h5");return s.setAttribute("class",t),s.innerHTML=e,userInfo.insertBefore(s,n),s}function addAction(e,t){let n=document.createElement("a");n.setAttribute("id",e),n.setAttribute("title",t);let s=document.createElement("i");s.setAttribute("class","btn-icon"),n.appendChild(s),actionButtons.appendChild(n)}
